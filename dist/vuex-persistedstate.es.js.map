{"version":3,"file":"vuex-persistedstate.es.js","sources":["../node_modules/deepmerge/dist/umd.js","../node_modules/shvl/dist/shvl.es.js","../index.js"],"sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.deepmerge = factory());\n}(this, (function () { 'use strict';\n\nvar isMergeableObject = function isMergeableObject(value) {\n\treturn isNonNullObject(value)\n\t\t&& !isSpecial(value)\n};\n\nfunction isNonNullObject(value) {\n\treturn !!value && typeof value === 'object'\n}\n\nfunction isSpecial(value) {\n\tvar stringValue = Object.prototype.toString.call(value);\n\n\treturn stringValue === '[object RegExp]'\n\t\t|| stringValue === '[object Date]'\n\t\t|| isReactElement(value)\n}\n\n// see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25\nvar canUseSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;\n\nfunction isReactElement(value) {\n\treturn value.$$typeof === REACT_ELEMENT_TYPE\n}\n\nfunction emptyTarget(val) {\n\treturn Array.isArray(val) ? [] : {}\n}\n\nfunction cloneUnlessOtherwiseSpecified(value, options) {\n\treturn (options.clone !== false && options.isMergeableObject(value))\n\t\t? deepmerge(emptyTarget(value), value, options)\n\t\t: value\n}\n\nfunction defaultArrayMerge(target, source, options) {\n\treturn target.concat(source).map(function(element) {\n\t\treturn cloneUnlessOtherwiseSpecified(element, options)\n\t})\n}\n\nfunction getMergeFunction(key, options) {\n\tif (!options.customMerge) {\n\t\treturn deepmerge\n\t}\n\tvar customMerge = options.customMerge(key);\n\treturn typeof customMerge === 'function' ? customMerge : deepmerge\n}\n\nfunction mergeObject(target, source, options) {\n\tvar destination = {};\n\tif (options.isMergeableObject(target)) {\n\t\tObject.keys(target).forEach(function(key) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(target[key], options);\n\t\t});\n\t}\n\tObject.keys(source).forEach(function(key) {\n\t\tif (!options.isMergeableObject(source[key]) || !target[key]) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(source[key], options);\n\t\t} else {\n\t\t\tdestination[key] = getMergeFunction(key, options)(target[key], source[key], options);\n\t\t}\n\t});\n\treturn destination\n}\n\nfunction deepmerge(target, source, options) {\n\toptions = options || {};\n\toptions.arrayMerge = options.arrayMerge || defaultArrayMerge;\n\toptions.isMergeableObject = options.isMergeableObject || isMergeableObject;\n\n\tvar sourceIsArray = Array.isArray(source);\n\tvar targetIsArray = Array.isArray(target);\n\tvar sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;\n\n\tif (!sourceAndTargetTypesMatch) {\n\t\treturn cloneUnlessOtherwiseSpecified(source, options)\n\t} else if (sourceIsArray) {\n\t\treturn options.arrayMerge(target, source, options)\n\t} else {\n\t\treturn mergeObject(target, source, options)\n\t}\n}\n\ndeepmerge.all = function deepmergeAll(array, options) {\n\tif (!Array.isArray(array)) {\n\t\tthrow new Error('first argument should be an array')\n\t}\n\n\treturn array.reduce(function(prev, next) {\n\t\treturn deepmerge(prev, next, options)\n\t}, {})\n};\n\nvar deepmerge_1 = deepmerge;\n\nreturn deepmerge_1;\n\n})));\n","function t(t,n,r){return void 0===(t=(n.split?n.split(\".\"):n).reduce(function(t,n){return t&&t[n]},t))?r:t}function n(t,n,r,e){return(n=n.split?n.split(\".\"):n).slice(0,-1).reduce(function(t,n){return t[n]=t[n]||{}},t)[n.pop()]=r,t}export{t as get,n as set};\n//# sourceMappingURL=shvl.es.js.map\n","import merge from 'deepmerge'\nimport * as shvl from 'shvl'\n\nexport default function(options, storage, key) {\n  options = options || {}\n  storage = options.storage || (window && window.localStorage)\n  key = options.key || 'vuex'\n  if (options.persistChanges === undefined) options.persistChanges = true\n  if (options.loadInitialState === undefined) options.loadInitialState = true\n\n  function canWriteStorage(storage) {\n    try {\n      storage.setItem('@@', 1)\n      storage.removeItem('@@')\n      return true\n    } catch (e) {}\n\n    return false\n  }\n\n  function getState(key, storage, value) {\n    try {\n      return (value = storage.getItem(key)) && typeof value !== 'undefined'\n        ? JSON.parse(value)\n        : undefined\n    } catch (err) {}\n\n    return undefined\n  }\n\n  function filter() {\n    return true\n  }\n\n  function setState(key, state, storage) {\n    return storage.setItem(key, JSON.stringify(state))\n  }\n\n  function reducer(state, paths) {\n    return paths.length === 0\n      ? state\n      : paths.reduce(function(substate, path) {\n          return shvl.set(substate, path, shvl.get(state, path))\n        }, {})\n  }\n\n  function subscriber(store) {\n    return function(handler) {\n      return store.subscribe(handler)\n    }\n  }\n\n  if (!canWriteStorage(storage)) {\n    throw new Error('Invalid storage instance given')\n  }\n\n  return function(store) {\n    if (options.loadInitialState) {\n      const savedState = shvl.get(options, 'getState', getState)(key, storage)\n\n      if (typeof savedState === 'object' && savedState !== null) {\n        store.replaceState(\n          merge(store.state, savedState, {\n            arrayMerge:\n              options.arrayMerger ||\n              function(store, saved) {\n                return saved\n              },\n            clone: false,\n          })\n        )\n      }\n    }\n\n    if (options.persistChanges) {\n      ;(options.subscriber || subscriber)(store)(function(mutation, state) {\n        if ((options.filter || filter)(mutation)) {\n          ;(options.setState || setState)(\n            key,\n            (options.reducer || reducer)(state, options.paths || []),\n            storage\n          )\n        }\n      })\n    }\n  }\n}\n"],"names":["module","isMergeableObject","value","isNonNullObject","stringValue","Object","prototype","toString","call","$$typeof","REACT_ELEMENT_TYPE","isReactElement","isSpecial","Symbol","for","cloneUnlessOtherwiseSpecified","options","clone","deepmerge","Array","isArray","defaultArrayMerge","target","source","concat","map","element","mergeObject","destination","keys","forEach","key","customMerge","getMergeFunction","arrayMerge","sourceIsArray","targetIsArray","sourceAndTargetTypesMatch","all","array","Error","reduce","prev","next","factory","t","n","r","split","storage","getState","getItem","JSON","parse","undefined","err","window","localStorage","persistChanges","loadInitialState","setItem","removeItem","e","canWriteStorage","store","savedState","shvl","replaceState","merge","state","arrayMerger","saved","subscriber","handler","subscribe","mutation","filter","setState","stringify","reducer","paths","length","substate","path","slice","pop"],"mappings":"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"}